# gatsby-plugin-feed

`gatsby-plugin-feed` allows you to create an RSS feed (or multiple feeds) for your Gatsby site. Under the hood it uses the [rss](https://www.npmjs.com/package/rss) npm package.

## Install

`npm install --save gatsby-plugin-feed`

## How to Use

You can add `gatsby-plugin-feed` to the list of plugins in the `gatsby-config.js` without any further configuration.

You will need to make sure though that your config file contains `siteMetadata` with title, description and siteUrl as these are expected by the plugin.

```javascript
// gatsby-config.js
siteMetadata: {
  title: `GatsbyJS`,
  description: `Blazing fast modern site generator for React`,
  siteUrl: `https://www.gatsbyjs.org`
},
plugins: [
  {
    resolve: `gatsby-plugin-feed`
  }
]
```

## Options

`gatsby-plugin-feed` sets reasonable default configuration, but this can still be overwritten via the options the plugin exposes:

* query

  A GraphQL query selecting site data that will be used later as general feed options.

  By default the fields that are queried are title, description and siteUrl.

  The list of available options can be found [in the rss module documentation](https://www.npmjs.com/package/rss#feedoptions)

* feeds

  Feeds is an array of objects, each of which will result in a separate feed.

  In order to generate more than one RSS feed at a time, pass a second object in the `feeds` array and configure accordingly.

  Each item in the feeds array is an object that consists of:

  * serialize

    The `<item>`s in the feed are generated by the `serialize` function.

    The function returns an array of objects.

    The available properties for each item can be found in the [rss module documentation](https://www.npmjs.com/package/rss#itemoptions).

  * query

    A GraphQL query selecting the items to be listed in the RSS feed. They will be passed to the `serialize` function as parameter.

  * output

    A string for the location and name of the RSS feed. For example with `output: "my-feed/my-rss.xml"`, your feed will be located at `{your-site-url}/my-feed/my-rss.xml`.

  * title

    During compilation, `link` elements for each feed will be added in the site's `head`. The title you specify here will be used in the `link` element `title` attribute.

If you want to customize your feed:

```javascript
// In your gatsby-config.js
plugins: [
  {
    resolve: `gatsby-plugin-feed`,
    options: {
      query: `
        {
          site {
            siteMetadata {
              title
              description
              siteUrl
              site_url: siteUrl
            }
          }
        }
      `,
      feeds: [
        {
          serialize: ({ query: { site, allMarkdownRemark } }) => {
            return allMarkdownRemark.edges.map(edge => {
              return Object.assign({}, edge.node.frontmatter, {
                description: edge.node.excerpt,
                date: edge.node.frontmatter.date,
                url: site.siteMetadata.siteUrl + edge.node.fields.slug,
                guid: site.siteMetadata.siteUrl + edge.node.fields.slug,
                custom_elements: [{ "content:encoded": edge.node.html }],
              })
            })
          },
          query: `
            {
              allMarkdownRemark(
                limit: 1000,
                sort: { order: DESC, fields: [frontmatter___date] },
                filter: {frontmatter: { draft: { ne: true } }}
              ) {
                edges {
                  node {
                    excerpt
                    html
                    fields { slug }
                    frontmatter {
                      title
                      date
                      author // If included it is the name of the item's creator.
                    }
                  }
                }
              }
            }
          `,
          output: "/my-rss-feed.xml",
          title: "Gatsby RSS Feed",
        },
      ],
    },
  },
]
```

# Preview RSS feed

This plugin only generates the `/rss.xml` file when run in `production` mode. To test your feed, run: `gatsby build && gatsby serve`.
